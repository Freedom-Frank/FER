# FER2013 é¡¹ç›®ç»“æ„è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®çš„æ–‡ä»¶å’Œç›®å½•ç»“æ„ã€‚

## ğŸ“ æ€»ä½“ç»“æ„

```
FER/
â”œâ”€â”€ README.md                      # é¡¹ç›®ä¸»æ–‡æ¡£
â”œâ”€â”€ requirements.txt               # Python ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ COMMANDS.txt                   # å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨
â”œâ”€â”€ PROJECT_STRUCTURE.md           # æœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ src/                          # æ ¸å¿ƒæºä»£ç 
â”œâ”€â”€ tools/                        # å·¥å…·è„šæœ¬
â”œâ”€â”€ scripts/                      # è‡ªåŠ¨åŒ–è„šæœ¬
â”œâ”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
â”‚
â”œâ”€â”€ data/                         # æ•°æ®ç›®å½•
â”œâ”€â”€ checkpoints/                  # æ¨¡å‹æ£€æŸ¥ç‚¹
â”œâ”€â”€ output/                       # è¾“å‡ºç»“æœ
â”œâ”€â”€ examples/                     # ç¤ºä¾‹ä»£ç 
â””â”€â”€ rank_0/                       # MindSpore è¿è¡Œæ—¶è¾“å‡º
```

---

## ğŸ”§ æ ¸å¿ƒä»£ç  (src/)

```
src/
â”œâ”€â”€ train.py          # è®­ç»ƒè„šæœ¬ - è®­ç»ƒé¢éƒ¨è¡¨æƒ…è¯†åˆ«æ¨¡å‹
â”œâ”€â”€ eval.py           # è¯„ä¼°è„šæœ¬ - åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½
â”œâ”€â”€ inference.py      # æ¨ç†è„šæœ¬ - å¯¹å•å¼ å›¾ç‰‡è¿›è¡Œè¡¨æƒ…é¢„æµ‹
â”œâ”€â”€ model.py          # æ¨¡å‹å®šä¹‰ - ResNet + æ³¨æ„åŠ›æœºåˆ¶
â”œâ”€â”€ model_legacy.py   # æ—§ç‰ˆæ¨¡å‹ - å…¼å®¹æ—§çš„æ£€æŸ¥ç‚¹æ–‡ä»¶
â”œâ”€â”€ dataset.py        # æ•°æ®åŠ è½½ - æ•°æ®å¢å¼ºã€Mixup ç­‰
â””â”€â”€ visualize.py      # å¯è§†åŒ–ç±» - FERVisualizer å®ç°
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- `train.py` - ä¸»è®­ç»ƒå…¥å£ï¼Œæ”¯æŒæ•°æ®å¢å¼ºã€Mixupã€å­¦ä¹ ç‡è°ƒåº¦ç­‰
- `eval.py` - è¯„ä¼°æ¨¡å‹ï¼Œè¾“å‡ºç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1-score å’Œæ··æ·†çŸ©é˜µ
- `inference.py` - å•å›¾æ¨ç†ï¼Œè‡ªåŠ¨æ£€æµ‹æ¨¡å‹ç‰ˆæœ¬
- `visualize.py` - æä¾›æ‘„åƒå¤´ã€å›¾ç‰‡ã€è§†é¢‘ã€æ‰¹é‡å¤„ç†åŠŸèƒ½

---

## ğŸ› ï¸ å·¥å…·è„šæœ¬ (tools/)

```
tools/
â”œâ”€â”€ demo_visualization.py          # å¯è§†åŒ–æ¼”ç¤ºä¸»ç¨‹åº
â”œâ”€â”€ generate_correct_samples.py    # ç”Ÿæˆé¢„æµ‹æ­£ç¡®çš„æ ·ä¾‹
â”œâ”€â”€ generate_samples_simple.py     # ç®€åŒ–çš„æ ·ä¾‹ç”Ÿæˆ
â”œâ”€â”€ generate_samples.py            # å®Œæ•´çš„æ ·ä¾‹ç”Ÿæˆï¼ˆå«å¯¹æ¯”è¡¨ï¼‰
â”œâ”€â”€ quick_samples.py               # å¿«é€Ÿæ ·ä¾‹ç”Ÿæˆ
â”œâ”€â”€ diagnose_correct_samples.py    # è¯Šæ–­å·¥å…·ï¼ˆæ£€æŸ¥æ¨¡å‹å‡†ç¡®ç‡ï¼‰
â”‚
â””â”€â”€ legacy/                        # åºŸå¼ƒ/ä¸´æ—¶è„šæœ¬
    â”œâ”€â”€ diagnose_model.py         # æ—§è¯Šæ–­è„šæœ¬
    â”œâ”€â”€ fix_visualization.py      # å¯è§†åŒ–ä¿®å¤è„šæœ¬
    â””â”€â”€ test_fix.py               # æµ‹è¯•ä¿®å¤è„šæœ¬
```

**å·¥å…·è¯´æ˜**ï¼š

### å¯è§†åŒ–å·¥å…·
- `demo_visualization.py` - ä¸»å¯è§†åŒ–ç¨‹åº
  - æ”¯æŒå®æ—¶æ‘„åƒå¤´ã€å›¾ç‰‡ã€è§†é¢‘ã€æ‰¹é‡å¤„ç†
  - ä½¿ç”¨æ–¹å¼ï¼šè§ [å¯è§†åŒ–æŒ‡å—](docs/guides/visualization_guide.md)

### æ ·ä¾‹ç”Ÿæˆå·¥å…·
- `generate_correct_samples.py` - **æ¨èç”¨äºå±•ç¤º**
  - åªç”Ÿæˆé¢„æµ‹æ­£ç¡®çš„æ ·ä¾‹
  - è‡ªåŠ¨è¿‡æ»¤é”™è¯¯é¢„æµ‹

- `generate_samples_simple.py` - ç®€åŒ–ç‰ˆ
  - ç”Ÿæˆæ··åˆæ ·ä¾‹ï¼ˆæ­£ç¡®+é”™è¯¯ï¼‰
  - é€‚åˆæ€§èƒ½åˆ†æ

- `generate_samples.py` - å®Œæ•´ç‰ˆ
  - åŒ…å«å¯¹æ¯”è¡¨å’Œç½‘æ ¼å±•ç¤º
  - é€‚åˆå®Œæ•´æŠ¥å‘Š

### è¯Šæ–­å·¥å…·
- `diagnose_correct_samples.py` - è¯Šæ–­æ¨¡å‹æ€§èƒ½
  - æµ‹è¯•æ¯ç§è¡¨æƒ…çš„å‡†ç¡®ç‡
  - é¢„ä¼°ç”Ÿæˆæ ·ä¾‹éœ€è¦çš„å°è¯•æ¬¡æ•°

---

## ğŸ“œ è‡ªåŠ¨åŒ–è„šæœ¬ (scripts/)

```
scripts/
â”œâ”€â”€ run_train.bat              # Windows è®­ç»ƒè„šæœ¬
â”œâ”€â”€ quick_test.bat             # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”œâ”€â”€ generate_samples.bat       # æ ·ä¾‹ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ wsl2_setup.sh              # WSL2 ç¯å¢ƒé…ç½®
â”œâ”€â”€ test_visualization.sh      # å¯è§†åŒ–æµ‹è¯•
â”œâ”€â”€ download_wsl_simple.ps1    # WSL æ•°æ®é›†ä¸‹è½½
â”œâ”€â”€ download_ubuntu.ps1        # Ubuntu æ•°æ®é›†ä¸‹è½½
â””â”€â”€ install_wsl2.ps1           # WSL2 å®‰è£…è„šæœ¬
```

**è„šæœ¬ç”¨é€”**ï¼š
- `.bat` æ–‡ä»¶ - Windows æ‰¹å¤„ç†è„šæœ¬
- `.sh` æ–‡ä»¶ - Linux/WSL2 Shell è„šæœ¬
- `.ps1` æ–‡ä»¶ - PowerShell è„šæœ¬

---

## ğŸ“š æ–‡æ¡£ç›®å½• (docs/)

```
docs/
â”œâ”€â”€ INDEX.md                   # æ–‡æ¡£æ€»ç´¢å¼•ï¼ˆå…¥å£ï¼‰
â”œâ”€â”€ README.md                  # æ–‡æ¡£è¯´æ˜
â”‚
â”œâ”€â”€ getting-started/           # å…¥é—¨æŒ‡å—
â”‚   â”œâ”€â”€ quickstart.md         # å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ setup.md              # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ overview.md           # é¡¹ç›®æ¦‚è§ˆ
â”‚
â”œâ”€â”€ guides/                    # ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ visualization_guide.md      # å¯è§†åŒ–æŒ‡å—
â”‚   â”œâ”€â”€ visualization_setup.md      # å¯è§†åŒ–ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ optimization.md             # æ¨¡å‹ä¼˜åŒ–æŠ€æœ¯
â”‚   â””â”€â”€ model_compatibility.md      # æ¨¡å‹å…¼å®¹æ€§è¯´æ˜
â”‚
â”œâ”€â”€ samples/                   # æ ·ä¾‹ç”Ÿæˆæ–‡æ¡£
â”‚   â”œâ”€â”€ README.md             # æ ·ä¾‹ç”Ÿæˆä¸»æ–‡æ¡£
â”‚   â”œâ”€â”€ quickstart.md         # å¿«é€Ÿå…¥é—¨
â”‚   â”œâ”€â”€ commands.md           # å‘½ä»¤é€ŸæŸ¥
â”‚   â”œâ”€â”€ examples.md           # ç¤ºä¾‹å±•ç¤º
â”‚   â”œâ”€â”€ correct-samples.md    # æ­£ç¡®æ ·ä¾‹ç”Ÿæˆ
â”‚   â””â”€â”€ troubleshooting.md    # æ•…éšœæ’é™¤
â”‚
â”œâ”€â”€ troubleshooting/           # æ•…éšœæ’é™¤
â”‚   â”œâ”€â”€ README.md             # æ•…éšœæ’é™¤æ€»ç´¢å¼•
â”‚   â””â”€â”€ general.md            # é€šç”¨é—®é¢˜
â”‚
â””â”€â”€ reference/                 # å‚è€ƒæ–‡æ¡£
    â””â”€â”€ changelog.md          # ç‰ˆæœ¬å†å²
```

**æ–‡æ¡£å¯¼èˆª**ï¼š
- **æ–°æ‰‹** â†’ ä» `docs/INDEX.md` å¼€å§‹
- **é—®é¢˜** â†’ æŸ¥çœ‹ `docs/troubleshooting/`
- **æ ·ä¾‹** â†’ æŸ¥çœ‹ `docs/samples/`

---

## ğŸ“Š æ•°æ®å’Œè¾“å‡º

### æ•°æ®ç›®å½• (data/)
```
data/
â””â”€â”€ FER2013/
    â””â”€â”€ fer2013.csv           # FER2013 æ•°æ®é›†ï¼ˆéœ€æ‰‹åŠ¨ä¸‹è½½ï¼‰
```

### æ¨¡å‹æ£€æŸ¥ç‚¹ (checkpoints/)
```
checkpoints/
â”œâ”€â”€ best_model.ckpt           # æœ€ä½³æ¨¡å‹
â”œâ”€â”€ fer-5_449.ckpt            # ç‰¹å®š epoch çš„æ£€æŸ¥ç‚¹
â””â”€â”€ ...                       # å…¶ä»–æ£€æŸ¥ç‚¹
```

### è¾“å‡ºç›®å½• (output/)
```
output/
â”œâ”€â”€ images/                   # å›¾ç‰‡å¤„ç†ç»“æœ
â”œâ”€â”€ videos/                   # è§†é¢‘å¤„ç†ç»“æœ
â”œâ”€â”€ webcam/                   # æ‘„åƒå¤´æˆªå›¾
â””â”€â”€ batch/                    # æ‰¹é‡å¤„ç†ç»“æœ
```

### æ ·ä¾‹è¾“å‡º
```
correct_samples/              # æ­£ç¡®æ ·ä¾‹è¾“å‡ºï¼ˆgenerate_correct_samples.pyï¼‰
samples_output/               # æ··åˆæ ·ä¾‹è¾“å‡ºï¼ˆgenerate_samples*.pyï¼‰
```

---

## ğŸ—‚ï¸ å…¶ä»–é‡è¦æ–‡ä»¶

### æ ¹ç›®å½•æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `README.md` | é¡¹ç›®ä¸»æ–‡æ¡£ï¼ŒåŒ…å«å¿«é€Ÿå¼€å§‹ã€ä½¿ç”¨è¯´æ˜ç­‰ |
| `requirements.txt` | Python ä¾èµ–åˆ—è¡¨ |
| `COMMANDS.txt` | å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨ï¼ˆå¤åˆ¶ç²˜è´´å³ç”¨ï¼‰ |
| `PROJECT_STRUCTURE.md` | æœ¬æ–‡æ¡£ï¼ˆé¡¹ç›®ç»“æ„è¯´æ˜ï¼‰ |
| `.gitignore` | Git å¿½ç•¥æ–‡ä»¶é…ç½® |

### é…ç½®æ–‡ä»¶
- `.gitignore` - Git å¿½ç•¥è§„åˆ™
- `requirements.txt` - Python ä¾èµ–

---

## ğŸ¯ å¿«é€ŸæŸ¥æ‰¾

### æˆ‘æƒ³...

#### è®­ç»ƒæ¨¡å‹
- **ä»£ç **ï¼š`src/train.py`
- **æ–‡æ¡£**ï¼š`docs/getting-started/quickstart.md`
- **è„šæœ¬**ï¼š`scripts/run_train.bat`

#### è¯„ä¼°æ¨¡å‹
- **ä»£ç **ï¼š`src/eval.py`
- **æ–‡æ¡£**ï¼š`README.md#è¯„ä¼°è„šæœ¬`

#### ç”Ÿæˆæ ·ä¾‹
- **ä»£ç **ï¼š`tools/generate_correct_samples.py`
- **æ–‡æ¡£**ï¼š`docs/samples/README.md`
- **å‘½ä»¤**ï¼š`COMMANDS.txt`

#### å¯è§†åŒ–ç»“æœ
- **ä»£ç **ï¼š`tools/demo_visualization.py`
- **æ–‡æ¡£**ï¼š`docs/guides/visualization_guide.md`

#### è§£å†³é—®é¢˜
- **æ–‡æ¡£**ï¼š`docs/troubleshooting/README.md`
- **è¯Šæ–­**ï¼š`tools/diagnose_correct_samples.py`

---

## ğŸ“ æ–‡ä»¶å‘½åè§„èŒƒ

### Python è„šæœ¬
- `*.py` - Python æºä»£ç 
- æ ¸å¿ƒåŠŸèƒ½ â†’ `src/`
- å·¥å…·è„šæœ¬ â†’ `tools/`
- åºŸå¼ƒè„šæœ¬ â†’ `tools/legacy/`

### æ–‡æ¡£
- `*.md` - Markdown æ–‡æ¡£
- å¤§å†™æ–‡æ¡£ â†’ é¡¹ç›®æ ¹ç›®å½•ï¼ˆå¦‚ `README.md`ï¼‰
- å°å†™æ–‡æ¡£ â†’ `docs/` å­ç›®å½•

### è„šæœ¬
- `*.bat` - Windows æ‰¹å¤„ç†
- `*.sh` - Linux/WSL2 Shell
- `*.ps1` - PowerShell

---

## ğŸ”„ æ¨èå·¥ä½œæµ

### 1. æ–°ç”¨æˆ·å…¥é—¨
```
README.md â†’ docs/INDEX.md â†’ docs/getting-started/quickstart.md
```

### 2. è®­ç»ƒæ¨¡å‹
```
src/train.py â†’ src/eval.py â†’ checkpoints/best_model.ckpt
```

### 3. ç”Ÿæˆæ ·ä¾‹
```
tools/diagnose_correct_samples.py â†’ tools/generate_correct_samples.py
â†’ correct_samples/
```

### 4. å¯è§†åŒ–
```
tools/demo_visualization.py â†’ output/
```

---

## ğŸ’¡ ç»´æŠ¤å»ºè®®

### æ·»åŠ æ–°åŠŸèƒ½
1. æ ¸å¿ƒåŠŸèƒ½ â†’ `src/`
2. å·¥å…·è„šæœ¬ â†’ `tools/`
3. æ–‡æ¡£ â†’ `docs/` å¯¹åº”å­ç›®å½•

### æ¸…ç†åŸåˆ™
- ä¸´æ—¶æ–‡ä»¶ â†’ `tools/legacy/`
- åºŸå¼ƒæ–‡æ¡£ â†’ ç§»é™¤æˆ–å½’æ¡£
- è¾“å‡ºæ–‡ä»¶ â†’ æ·»åŠ åˆ° `.gitignore`

### æ–‡æ¡£æ›´æ–°
- ä¿®æ”¹ä»£ç  â†’ åŒæ­¥æ›´æ–°æ–‡æ¡£
- æ–°å¢åŠŸèƒ½ â†’ æ·»åŠ åˆ° `docs/INDEX.md`
- ç‰ˆæœ¬æ›´æ–° â†’ æ›´æ–° `docs/reference/changelog.md`

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [ä¸»æ–‡æ¡£](README.md)
- [æ–‡æ¡£ç´¢å¼•](docs/INDEX.md)
- [å‘½ä»¤é€ŸæŸ¥](COMMANDS.txt)
- [å…¥é—¨æŒ‡å—](docs/getting-started/quickstart.md)

---

**æœ€åæ›´æ–°**ï¼š2025-01
**ç»´æŠ¤è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ
